
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var cart = ViewBag.Cart as ShopMyPham.ViewModel.CartModel;
    var user = Session["user"] as ShopMyPham.Models.QuanTri;
}
<script>
    $(function () {

        $('#updateCart').click(function () {
            var id = $('#proID').val();
            var quantity = $('#itemQuantity').val();
            $.ajax({
                url: "/gio-hang/cap-nhat-san-pham/" + id + "/" + quantity,
                type: 'POST',
                success: function () {
                    $('.mini-cart-content').load('@Url.Content("~/load-cart")');
                    $('#CartDetails').load('@Url.Content("~/Cart")');
                }
            });
        });

    });
</script>
<h1>asdasdasdasasdasdDASDAS</h1>

<div class="cart-title-area">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="car-header-title">
                    <h2>Giỏ Hàng Của Bạn</h2>
                    <input type="hidden" id="cart-product-id" value="@cart.Items.FirstOrDefault().SanPhamID" />
                </div>
            </div>
        </div>
    </div>
</div>
<br /><br /><br />


<div class="cart-main-area">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <form>
                    <div class="table-content table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th class="product-thumbnail"></th>
                                    <th class="product-name">Sản Phẩm</th>
                                    <th class="product-price">Giá</th>
                                    <th class="product-quantity">Số Lượng</th>
                                    <th class="product-subtotal">Thành Tiền</th>
                                    <th class="product-remove">Xóa</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in cart.Items)
                                {
                                    <tr>
                                        @*<td class="product-thumbnail"><a href="#"><img src="@cart.Items.FirstOrDefault().SanPhamHinh.TenHinh" alt="" /></a></td>
                                            <td class="product-name"><a href="#">@cart.Items.FirstOrDefault().SanPham.TenSanPham</a></td>
                                            <td class="product-price"><span class="amount">@string.Format("{0:#,##0 VND}", @cart.Items.FirstOrDefault().SanPham.GiaBan)</span></td>
                                            <td class="product-quantity"><input type="number" id="cart-quantity" value="@cart.Items.FirstOrDefault().SoLuong" /></td>
                                            <td class="product-subtotal">@string.Format("{0:#,##0 VND}", @cart.Items.FirstOrDefault().SanPham.GiaBan * cart.Items.FirstOrDefault().SoLuong) </td>
                                            <td class="product-remove"><a href="#"><i class="fa fa-times"></i></a></td>*@
                                        <td class="product-thumbnail"><a href="#"><img src="Photos/SP/@item.SanPhamHinh.TenHinh" alt="" /></a></td>
                                        <td class="product-name"><a href="#">@item.SanPham.TenSanPham</a></td>
                                        <td class="product-price"><input type="hidden" id="proID" value="@item.SanPhamID" /> @string.Format("{0:#,##0 VND}", @item.SanPham.GiaBan)</td>
                                        <td class="product-quantity"><input type="number" data-item="@item.SanPhamID" id="itemQuantity" value="@item.SoLuong" /></td>  @*id="cart-quantity_@item.SanPhamID"*@
                                        <td class="product-subtotal totalProduct" id="changeQuantity">@string.Format("{0:#,##0 VND}", @item.SanPham.GiaBan * item.SoLuong) </td>
                                        <td class="product-remove">
                                            <a href="@Url.Action("_CartDetails", "Cart", new { id = @item.SanPhamID, quantity = item.SoLuong })"><i class="fa fa-times"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                        <input type="button" id="updateCart" value="CẬP NHẬT" />
                    </div>
                    <div class="row">
                        <div class="col-md-8 col-sm-7">
                            <div class="coupon">
                                <h3>Sản Phẩm Sẽ Được Giao Tới :</h3>
                                <br />
                                <h3>Địa Chỉ: @user.DiaChi</h3>
                                <br />
                                <h3>Số Điện Thoại: @user.Sdt</h3>
                                <br />
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-5">
                            <div class="cart_totals">
                                <h2>Cart Totals</h2>
                                <table>
                                    <tbody>
                                        <tr class="cart-subtotal">
                                            <th>Subtotal</th>
                                            <td><span class="amount">@cart.Total().ToString("#,##0VND")</span></td>
                                        </tr>
                                        <tr class="shipping">
                                            <th>Shipping</th>
                                            <td>
                                                <ul id="shipping_method">
                                                    <li>
                                                        <label>
                                                            Flat Rate: <span class="amount">£7.00</span>
                                                        </label>
                                                    </li>
                                                    <li>
                                                        <label>
                                                            Free Shipping
                                                        </label>
                                                    </li>
                                                    <li></li>
                                                </ul>
                                                <p><a class="shipping-calculator-button" href="#">Calculate Shipping</a></p>
                                            </td>
                                        </tr>
                                        <tr class="order-total">
                                            <th>Total</th>
                                            <td>
                                                <strong><span class="amount">@cart.Total().ToString("#,##0VND")</span></strong>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="wc-proceed-to-checkout">
                                    <a href="#">Xác Nhận</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>